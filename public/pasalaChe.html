<!-- ====================== INICIO index.html ====================== -->
<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="description"
      content="PASALA CH칄 - Juego interactivo de preguntas sobre f칰tbol."
    />
    <!-- Evitar zoom en m칩vil -->
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no"
    />
    <title>PASALA CH칄</title>
    <!-- Google AdSense (opcional) -->
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9579152019412427"
      crossorigin="anonymous"
    ></script>
    <!-- Hoja de Estilos Principal (luego uniremos con ranking.css) -->
    <link rel="stylesheet" href="css/styles.css" />
    <!-- Fuentes: Poppins y Oswald -->
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&family=Oswald:wght@500;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="container">
      <!-- Nav superior -->
      <nav class="top-nav">
        <a href="profile.html" class="nav-link" data-i18n="nav_profile"
          >Ver Perfil</a
        >
        <button id="share-btn" class="share-btn" data-i18n="share_button">
          Compartir
        </button>
      </nav>

      <!-- Pantalla de Login -->
      <section id="login-screen" class="screen">
        <h1 id="title-text" data-i18n="loginTitle">PASALA CH칄</h1>
        <p id="login-text" data-i18n="loginPrompt">Ingresa tu nombre para comenzar:</p>
        <input type="text" id="username" placeholder="Tu nombre de usuario" />
        <button id="login-btn" class="start-btn" data-i18n="loginButton">
          INGRESAR
        </button>

        <!-- Cartel de Reglas -->
        <div id="game-rules" class="game-rules">
          <h2 data-i18n="rulesTitle">Reglas del Juego</h2>
          <ul>
            <li>
              <strong data-i18n="ruleError_strong">M치ximo de Errores:</strong>
              <span data-i18n="ruleError_text"
                >Hasta 2 errores (al tercer error pierdes).</span
              >
            </li>
            <li>
              <strong data-i18n="ruleHelp_strong">HELP:</strong>
              <span data-i18n="ruleHelp_text"
                >Tienes 2 oportunidades para obtener pista (primeras 3 letras).</span
              >
            </li>
            <li>
              <strong data-i18n="ruleIncomplete_strong"
                >Respuesta Incompleta:</strong
              >
              <span data-i18n="ruleIncomplete_text"
                >Puedes enviar respuestas incompletas hasta 2 veces.</span
              >
            </li>
            <li>
              <strong data-i18n="ruleTimeLabel">Tiempo.</strong>
              <span data-i18n="ruleTimeValue"
                >F치cil: 300'' / Normal: 240'' / Dif칤cil: 200''</span
              >
            </li>
            <li>
              <strong data-i18n="ruleSpelling_strong">Ortograf칤a:</strong>
              <span data-i18n="ruleSpelling_text"
                >Se toleran errores m칤nimos.</span
              >
            </li>
          </ul>
        </div>

        <!-- Cartel Promo (inicialmente oculto) -->
        <div id="promo-msg" class="promo-msg hidden">
          <em data-i18n="promoMsg"
            >M치s de 1000 preguntas que tocan de manera aleatoria para jugar sin
            parar!</em
          >
        </div>

        <!-- Contenedor para "Iniciar Juego" (oculto inicialmente) -->
        <div id="start-container" class="hidden">
          <div id="difficulty-container">
            <label for="difficulty" data-i18n="difficultyLabel"
              >Dificultad:</label
            >
            <select id="difficulty">
              <option value="hard" data-i18n="difficultyHard">Dif칤cil</option>
              <option
                value="normal"
                data-i18n="difficultyNormal"
                selected
              >Normal</option>
              <option value="easy" data-i18n="difficultyEasy">F치cil</option>
            </select>
          </div>
          <button id="start-game" class="start-btn" data-i18n="startGameButton">
            INICIAR JUEGO
          </button>
        </div>
      </section>

      <!-- Pantalla de Juego -->
      <section id="game-screen" class="screen hidden">
        <header>
          <h1 id="game-title" data-i18n="gameTitle">PASALA CH칄</h1>
          <div class="header-controls">
            <p id="user-display" class="user-display"></p>
            <button id="sound-toggle" class="sound-toggle" data-i18n="soundOn">
              游댉 Sound: On
            </button>
          </div>
          <p id="timer" class="timer" data-i18n="timer">Tiempo: 240s</p>
        </header>
        <div class="content">
          <div class="rosco-container">
            <div id="rosco" class="rosco"></div>
            <!-- Contenedor central para la pregunta -->
            <div id="question-container" class="question-container">
              <div id="question">
                <div class="question-letter">A</div>
                <div class="question-text" data-i18n="questionPlaceholder">
                  Presiona "Iniciar Juego" para comenzar
                </div>
              </div>
            </div>
            <div id="side-messages" class="side-messages">
              <div id="hint-container" class="hint-container"></div>
              <div
                id="incomplete-feedback-container"
                class="incomplete-feedback-container"
              ></div>
            </div>
          </div>
          <!-- Panel con input de respuesta y botones -->
          <div class="panel">
            <input
              type="text"
              id="answer"
              placeholder="Escribe tu respuesta y presiona Enter"
              autocomplete="off"
            />
            <div class="panel-buttons">
              <button id="help" class="help-btn" data-i18n="helpBtn">HELP</button>
              <button id="action-btn" class="action-btn" data-i18n="passBtn">
                Pasala Ch칠
              </button>
            </div>
          </div>
        </div>
      </section>
    </div>

    <!-- Scripts -->
    <script src="js/main.js"></script>

    <!-- Infolinks Integration (opcional) -->
    <script type="text/javascript">
      var infolinks_pid = 3434028;
      var infolinks_wsid = 0;
    </script>
    <script
      type="text/javascript"
      src="http://resources.infolinks.com/js/infolinks_main.js"
    ></script>

    <!-- Script para manejar la vista "playAgain" -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // Detectar si venimos con el par치metro ?playAgain=true
        const params = new URLSearchParams(window.location.search);
        const playAgain = params.get("playAgain");

        if (playAgain === "true") {
          // Ocultamos los elementos de login
          document.getElementById("username").style.display = "none";
          document.getElementById("login-btn").style.display = "none";
          document.getElementById("login-text").style.display = "none";
          document.getElementById("game-rules").classList.add("hidden");

          // Mostramos el cartel promo y el contenedor de "Iniciar Juego"
          document.getElementById("promo-msg").classList.remove("hidden");
          document.getElementById("start-container").classList.remove("hidden");
        }

        // 1) Al hacer clic en "INGRESAR" (cuando NO est치 en modo playAgain)
        const loginBtn = document.getElementById("login-btn");
        if (loginBtn) {
          loginBtn.addEventListener("click", () => {
            const usernameInput = document.getElementById("username");
            const username = usernameInput.value.trim();
            if (!username) {
              alert("Por favor, ingresa un nombre de usuario.");
              return;
            }
            // Ocultamos los elementos de login
            usernameInput.style.display = "none";
            loginBtn.style.display = "none";
            document.getElementById("login-text").style.display = "none";
            document.getElementById("game-rules").classList.add("hidden");

            // Mostramos el cartel promo y el contenedor de "Iniciar Juego"
            document.getElementById("promo-msg").classList.remove("hidden");
            document.getElementById("start-container").classList.remove("hidden");
          });
        }
      });
    </script>
  </body>
</html>
<!-- ====================== FIN index.html ====================== -->

<!-- ====================== INICIO profile.html ====================== -->
<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="Perfil de PASALA CH칄" />
    <!-- Evitar zoom en m칩vil -->
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no"
    />
    <title>Perfil - PASALA CH칄</title>
    <link rel="stylesheet" href="css/styles.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&family=Oswald:wght@500;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="container">
      <nav style="text-align: right; margin-bottom: 10px;">
        <a
          href="index.html"
          class="nav-link"
          id="volver-profile"
          style="
            color: var(--white);
            text-decoration: none;
            font-size: 1rem;
            background: var(--btn-bg);
            padding: 5px 10px;
            border-radius: 5px;
          "
          >Volver</a
        >
      </nav>
      <h1 class="profile-title">Tu Perfil</h1>
      <div id="profile-container"></div>
    </div>

    <script>
      async function updateProfileDisplay() {
        const container = document.getElementById("profile-container");
        try {
          const res = await fetch("/api/profile");
          if (!res.ok) throw new Error("No se pudo cargar el perfil");
          const profile = await res.json();
          if (!profile) {
            container.innerHTML =
              "<p>No se encontr칩 un perfil. Juega algunas partidas para crearlo.</p>";
          } else {
            const avgTime =
              profile.totalQuestions > 0
                ? (profile.totalTime / profile.totalQuestions).toFixed(2)
                : "N/A";

            // Mostrar logros
            let achievementsHtml = "";
            if (
              profile.achievements &&
              Object.keys(profile.achievements).length > 0
            ) {
              achievementsHtml += "<ul>";
              for (const ach in profile.achievements) {
                achievementsHtml += `<li><strong>${ach}</strong>: ${profile.achievements[ach]}</li>`;
              }
              achievementsHtml += "</ul>";
            } else {
              achievementsHtml = "<p>No se han acumulado logros.</p>";
            }

            // Historial de partidas
            let historyHtml = "";
            if (
              profile.history &&
              Array.isArray(profile.history) &&
              profile.history.length > 0
            ) {
              historyHtml += "<h3>Historial de Partidas</h3><ul>";
              profile.history.forEach((game) => {
                historyHtml += `<li>
                  <strong>${game.date}</strong>: 
                  Correctas: ${game.correct}, 
                  Err칩neas: ${game.wrong}, 
                  Total: ${game.total}, 
                  Tiempo: ${game.time}s
                </li>`;
              });
              historyHtml += "</ul>";
            } else {
              historyHtml += "<p>No hay historial de partidas.</p>";
            }

            container.innerHTML = `
              <p><strong>Partidas Jugadas:</strong> ${profile.gamesPlayed}</p>
              <p><strong>Respuestas Correctas:</strong> ${profile.totalCorrect}</p>
              <p><strong>Respuestas Err칩neas:</strong> ${profile.totalWrong}</p>
              <p><strong>Total de Preguntas:</strong> ${profile.totalQuestions}</p>
              <p><strong>Tiempo Total:</strong> ${profile.totalTime}s</p>
              <p><strong>Tiempo Promedio:</strong> ${avgTime}s</p>
              <hr>
              <h3>Logros Acumulados:</h3>
              ${achievementsHtml}
              <hr>
              ${historyHtml}
            `;
          }
        } catch (e) {
          console.error(e);
          container.innerHTML = "<p>Error al cargar el perfil.</p>";
        }
      }

      document.addEventListener("DOMContentLoaded", () => {
        updateProfileDisplay();
        setInterval(updateProfileDisplay, 10000);

        // Cambiar bot칩n "Volver" seg칰n si ya jug칩
        const volverProfile = document.getElementById("volver-profile");
        if (volverProfile) {
          const alreadyPlayed = localStorage.getItem("alreadyPlayed") === "true";
          if (alreadyPlayed) {
            volverProfile.textContent = "Volver a jugar";
            volverProfile.addEventListener("click", (e) => {
              e.preventDefault();
              window.location.href = "index.html?playAgain=true";
            });
          }
        }
      });
    </script>
  </body>
</html>
<!-- ====================== FIN profile.html ====================== -->

<!-- ====================== INICIO ranking.html ====================== -->
<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Ranking Global - Rosco Futbolero</title>
    <!-- Evitar zoom en m칩vil -->
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no"
    />
    <link rel="stylesheet" href="css/ranking.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="ranking-container">
      <h1>Ranking Global del Rosco Futbolero</h1>
      <!-- Contenedor con scroll para ver todos los registros -->
      <div class="ranking-scroll">
        <table id="ranking-table">
          <thead>
            <tr>
              <th>Jugador</th>
              <th>Correctas</th>
              <th>Err칩neas</th>
              <th>Total</th>
              <th>Fecha</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
      <button id="volver">Volver al inicio</button>
    </div>
    <script src="js/ranking.js"></script>

    <!-- Script para cambiar texto y acci칩n del bot칩n si ya se jug칩 -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const volverBtn = document.getElementById("volver");
        if (!volverBtn) return;

        const alreadyPlayed = localStorage.getItem("alreadyPlayed") === "true";

        if (alreadyPlayed) {
          volverBtn.textContent = "Volver a jugar";
          // Cambiamos el comportamiento para llevar a index.html con ?playAgain=true
          volverBtn.addEventListener("click", () => {
            window.location.href = "index.html?playAgain=true";
          });
        } else {
          // Si NO ha jugado o no est치 marcado
          volverBtn.addEventListener("click", () => {
            window.location.href = "index.html";
          });
        }
      });
    </script>
  </body>
</html>
<!-- ====================== FIN ranking.html ====================== -->
